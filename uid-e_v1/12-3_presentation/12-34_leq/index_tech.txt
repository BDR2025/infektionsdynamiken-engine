/*!
 * File:      README.md
 * Folder:    12-3_presentation/vectors/core-equation
 * Project:   UID-Explore Presentation Layer Â· Vector-Tool Living Equation
 * Type:      Notes / Overview
 * Authors:   B. D. Rausch Â· A. Heinz
 * Contact:   info@infectiondynamics.eu Â· info@infektionsdynamiken.de
 * License:   CC BY 4.0
 *
 * Created:   2025-09-28
 * Updated:   2025-09-28
 * Version:   0.9.47
 * Changelog: - Frozen baseline (flink): Freeze-Mode + rAF-Slots; tau=0.08; feed=80 ms; Pointer live
 */

# Vector-Tool Living Equation (Triple)

**Triple-Form:**  
1) links: \( \dfrac{d}{dt} \) vor dem Zustandsvektor (S,E,I,R â€¦)  
2) mitte: **symbolischer** groÃŸer Vektor (farbige Terme)  
3) rechts: **numerischer** groÃŸer Vektor, identisches Layout wie (2), live mit Werten

Das Widget koppelt an den UID-Explore Event-Bus (`uid:e:*`), ist modell-agnostisch (SEIR, SIR, SIS, SIRD, SIRV via **ModelSpecs**) und rendert mit **MathJax v3**.

---

## Features (Kurz)
- **Freeze-Mode:** rechter Block wird **einmal** typesettet â†’ danach nur Slot-Text (ohne Re-Typeset) â†’ sehr flÃ¼ssig.  
- **rAF-Smoothing:** Werte laufen sichtbar **weich** (Default Ï„ = **0.08 s**) wie bei Live-KPIs.  
- **Vor-Kalibrierung:** misst Max-Breiten (ZÃ¤hler/Nenner/Koef.) + **Line-Locks je Zeile** â†’ kein Breiten-Pumpen.  
- **Didaktik:** farbige Terme, Puls/Bold auf **Container-Ebene** (stabil im Play).  
- **Model-agnostisch:** gleiche Engine, nur **ModelSpec** wechselt (SEIR, SIR, SIS, SIRD, SIRV).

---

## Ordner & Dateien
core-equation/
â”œâ”€ index.js # Orchestrator: Bus, Spec, Pointer-Direct-Update, Feed (80 ms)
â”œâ”€ view.js # View: Pre-Calibrate, Freeze-Slots (rAF 60 fps), Puls-Host
â”œâ”€ scheduler.js # Throttle-Helper fÃ¼r den normalen Feed
â”œâ”€ format.js # Zahlformatierung (locale-aware)
â”œâ”€ contracts.js # normalizeParams, FLOW_FNS (betaSI_N, sigmaE, gammaI, â€¦)
â”œâ”€ tex-symbolic.js # TeX: Left + Middle (symbolisch, row-Wrapper)
â”œâ”€ tex-numeric.js # TeX: Right (numerisch, identische Struktur, Klassen/Slots)
â””â”€ model-specs/
â”œâ”€ index.js # getSpec()
â”œâ”€ seir.js Â· sir.js Â· sis.js Â· sird.js Â· sirv.js

yaml
Code kopieren

---

## Einbau (Schnellstart)

**1) CSS (am besten am Ende deiner globalen Styles laden):**
```html
<link rel="stylesheet" href="../12-3_presentation/vectors/core-equation/styles.css">
2) MathJax v3 konfigurieren (ohne chtml.linebreaks!):

html
Code kopieren
<script>
  window.MathJax = {
    loader: { load: ['[tex]/html'] },
    tex: {
      inlineMath: [['$','$'],['\\(','\\)']],
      displayMath: [['\\[','\\]'], ['$$','$$']],
      packages: {'[+]':['html']}
    }
  };
</script>
<script defer id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
3) Modul laden (auto-mount):

html
Code kopieren
<script type="module" src="../12-3_presentation/vectors/core-equation/index.js"></script>
Import-Map Voraussetzung (so verwendet im Projekt):
@uid/base/ @uid/input/ @uid/pres/ @uid/support/

Bus-Kopplung (sticky)
Das Widget hÃ¶rt auf:

uid:e:params:ready â†’ Meta/Modell

uid:e:model:update â†’ normalisierte Parameter (Î², Î³, Ïƒ, Î¼, Î½, N, â€¦)

uid:e:sim:data â†’ Serie { t, S, E, I, R, â€¦ }

uid:e:sim:pointer â†’ { idx } (Playhead)

Pointer-Events werden unthrottled verarbeitet (direkter Slot-Update fÃ¼r â€Liveâ€œ-GefÃ¼hl). Alle anderen Updates gehen Ã¼ber einen sanften Feed (Default 80 ms).

Performance-Design
Freeze-Mode:
Rechte Matrix wird einmal typesettet. Danach werden nur noch Slots (Textknoten) geschrieben:

0 Re-Typesets im Play

rAF-Loop (60 fps): visuelles Smoothing mit 
ğœ
=
0.08
Ï„=0.08 s

Line-Locks je Zeile + Struts in BrÃ¼chen â†’ kein horizontales/vertikales Zittern

Akzeptanzkriterien (intern):

Î”W_right â‰¤ 3 px (typisch 0â€“2 px)

Frac-Jitter â‰¤ 0.5 px

Pulse-Uptime â‰¥ 95 % (bei aktivem Puls)

Winner-Sync = 100 %

ModelSpecs (Beispiele)
SEIR

states: [S,E,I,R]

rows:
S: âˆ’ Î²Â·SÂ·I/N
E: + Î²Â·SÂ·I/N âˆ’ ÏƒÂ·E
I: + ÏƒÂ·E âˆ’ Î³Â·I
R: + Î³Â·I

flows: betaSI_N, sigmaE, gammaI

derivTex: 
ğ›½
=
ğ‘…
0
ğ›¾
,
â€…â€Š
ğ›¾
=
1
/
ğ·
,
â€…â€Š
ğœ
=
1
/
ğ¿
,
â€…â€Š
ğ‘…
e
f
f
=
ğ‘…
0
ğ‘†
/
ğ‘
Î²=R 
0
â€‹
 Î³,Î³=1/D,Ïƒ=1/L,R 
eff
â€‹
 =R 
0
â€‹
 S/N

SIR / SIS / SIRD / SIRV analog; nur Spec austauschen.

Konfiguration & Tuning
Smoothing (View): setSmoothMode('off'|'normal'|'strong')
â€“ Default â€flinkâ€œ: Ï„ = 0.08 s in view.js

Feed (Index): Throttle-Intervall im Orchestrator (Default 80 ms)

Pointer: unthrottled, immer direkt

Optional: Einen UI-Chip â€Smooth: Off / Normal / Strongâ€œ nachrÃ¼sten (schaltet nur Ï„).

Troubleshooting
Rote \class{â€¦}{â€¦} sichtbar:
â†’ MathJax [tex]/html nicht aktiv oder \[...\] nicht in displayMath. Fix: Config oben exakt Ã¼bernehmen.

â€Invalid option linebreaksâ€œ:
â†’ chtml.linebreaks nicht in v3 benutzen. Entfernen.

Puls stoppt beim Play:
â†’ Stelle sicher, dass Puls-Klassen auf Container (block-mid / block-right) liegen, nicht auf dynamischen MJX-Nodes.

Zahlen ruckeln / treppen:
â†’ Feed auf 60â€“80 ms, Ï„ auf 0.08 s. Pointer ist live. (Freeze-Mode muss aktiv sein.)

Nur ein Teil bewegt sich:
â†’ PrÃ¼fe, ob alle Slot-Instanzen gesetzt werden (querySelectorAll statt querySelector). In view.js (â‰¥ v4.6.0) ist das behoben.

Dev-Diagnostik (optional)
EQ-Probe (Jitter, Typeset/s): zeigt Î”W/Î”X rechts, Frac-Jitter, Pulse-Uptime, Winner-Sync.

Slot-Probe: misst pro Slot (Î²,Î³,Ïƒ,Î¼,Î½,S,E,I,N) nodes & updates/s â†’ erkennt, wenn Instanzen stehen bleiben.

Die Snippets liegen in den internen Dev-Notizen; bei Bedarf integrieren (HUD mit Stop+Download).

Lizenz
CC BY 4.0 â€“ Bitte Quelle nennen: UID-Explore Presentation Layer Â· Vector-Tool Living Equation.